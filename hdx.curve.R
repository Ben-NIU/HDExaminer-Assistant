hdx.curve<-function(data, pointsize,transparency, state1, state2, color1, color2, Nrow=3, Ncol=3){
  limits<-aes(ymax=D.percent +sd, ymin=D.percent -sd,width=0.1)
  ggplot(data, aes(x=Time, y=D.percent, group=State,color=State)) + geom_point(size=pointsize) + geom_line(alpha=transparency,size=2)+lims(y=c(-2,100)) + geom_errorbar(limits) + scale_x_continuous(trans="log10") + annotation_logticks(base=10, sides="b",size=0.7, linetype = 1,mid = unit(0.1,"cm"),long = unit(0.2,"cm")) +facet_wrap(~peptide, nrow=Nrow, ncol=Ncol, scales = "free_y") + scale_color_manual(name="Sample",breaks=as.character(unique(data$State)), labels=c(state1, state2), values=c(color1, color2)) +theme(strip.background=element_rect(fill="white")) + theme(panel.background=element_rect(fill="white",color="black"), panel.grid.major=element_line(color="gray95"),panel.grid.minor=element_blank(),strip.text=element_text(face="bold",size=12)) + labs(x="Time (sec)",y="Deuterium uptake %") + theme(legend.position="top")+theme(panel.border=element_rect(fill=NA, color="black", size=1))+ theme(legend.title=element_text(color="black", size=14, face="bold"), legend.text=element_text(size=14, color="black",face="bold")) + theme(axis.text.x=element_text(size=13),axis.text.y=element_text(size=13), axis.title.x=element_text(size=13),axis.title.y=element_text(size=13)) + theme(aspect.ratio = 0.8)
}